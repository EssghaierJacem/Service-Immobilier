<div class="container py-4">
  <h2 class="text-center fw-bold mb-4">ğŸ  Liste des RÃ©sidences</h2>

  <div class="d-flex justify-content-center mb-4">
    <div class="input-group search-container">
      <span class="input-group-text bg-primary text-white"><i class="bi bi-search"></i></span>
      <input type="text" [(ngModel)]="searchAddress" placeholder="Rechercher par adresse" class="form-control">
    </div>
  </div>

  <div class="row g-4">
    <div class="col-md-4" *ngFor="let residence of filteredResidences">
      <div class="card residence-card">
        <img [src]="residence.image" class="card-img-top" alt="{{ residence.name }}">
        <div class="card-body">
          <h5 class="card-title">{{ residence.name }}</h5>

          <button (click)="toggleLocation(residence)" class="btn btn-info mb-3">
            <i class="bi bi-pin"></i> Show Location
          </button>

          <p *ngIf="showLocations[residence.id]" class="card-text location-text">
            Adresse: {{ residence.address }}
          </p>

          <div>
            <div *ngIf="residence.status === 'Disponible'" class="badge bg-success">Disponible</div>
            <div *ngIf="residence.status === 'Vendu'" class="badge bg-danger">Vendu</div>
            <div *ngIf="residence.status === 'En Construction'" class="badge bg-warning">En Construction</div>

            <button (click)="toggleFavorite(residence)" class="btn like-btn">
              <i class="bi" [ngClass]="isFavorite(residence) ? 'bi-heart-fill' : 'bi-heart'"></i> Add to Favs
            </button>

            <!-- Details Button to navigate to ResidenceDetailsComponent -->
            <a [routerLink]="['/residences', residence.id]" class="btn btn-info mt-3">
              DÃ©tails
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-center mb-4">
    <button class="btn btn-secondary" (click)="toggleFavoritesView()">Voir les favoris</button>
  </div>

  <div *ngIf="showFavorites" class="mb-4">
    <h3 class="text-center mb-3">ğŸ… RÃ©sidences Favoris</h3>
    <div class="row g-4">
      <div class="col-md-4" *ngFor="let residence of favorites">
        <div class="card">
          <img [src]="residence.image" class="card-img-top" alt="{{ residence.name }}">
          <div class="card-body">
            <h5 class="card-title">{{ residence.name }}</h5>
            <p class="card-text">Adresse: {{ residence.address }}</p>
            <button class="btn btn-info" (click)="toggleFavorite(residence)">
              <i class="bi bi-heart-fill"></i> Retirer des favoris
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
